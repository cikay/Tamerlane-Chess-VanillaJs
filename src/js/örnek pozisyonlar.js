/*
////////////BAŞLANGIÇ POZİSYONU//////////////////////////////////////////////////////////////////////////

var Start_Fen="f1d1i1i1d1f/kamzvsgzmak1/rnxheqybctp/92/92/92/92/PTCBYQEHXNR/KAMZGSVZMAK1/F1D1I1I1D1F w";
f1d1i1i1d1f/1kamzvsgzmak/rnxheqybctp/92/92/92/92/PTCBYQEHXNR/KAMZGSVZMAK1/F1D1I1I1D1F

///////////////////////////////////////////////////////////////////////////////////////////////////////


ÖRNEK POZİSYONLAR

//////SAH HAREKET KONTROL POZİSYONLARI///////////////////////////////////////////////////////////////
92/9d2/9z2/5S5/92/65/515/92/93/92 w
92/9D2/9Z2/5s5/92/65/515/92/93/92 b


92/5s6/92/92/41114/5M5/41114/92/5S6/92 w
///////////////////////////////////////////////////////////////////////////////////////////////////////


//////GENERAL HAREKET KONTROL POZİSYONLARI///////////////////////////////////////////////////////////////
92/9d2/9z2/5G5/92/65/515/92/93/92 w
92/9d2/5z5/5G5/92/65/515/92/93/92 w
92/9d2/4z6/5G5/92/65/515/92/93/92 w
92/9d2/4z6/5G5/5P5/65/515/92/93/92 w
92/9d2/5P5/5G5/4z6/65/515/92/93/92 w

92/9D2/9Z2/5g5/92/65/515/92/93/92 b
92/9D2/5Z5/5g5/92/65/515/92/93/92 b

///////////////////////////////////////////////////////////////////////////////////////////////////////

//////VEZIR HAREKET KONTROL POZİSYONLARI///////////////////////////////////////////////////////////////
92/9d2/9z2/5V5/92/65/515/92/93/92 w
92/9D2/9Z2/5v5/92/65/515/92/93/92 b

///////////////////////////////////////////////////////////////////////////////////////////////////////


//////FİL HAREKET KONTROL POZİSYONLARI///////////////////////////////////////////////////////////////
92/9d2/9z2/5S5/92/65/515/92/93/92 w
92/9D2/9Z2/5s5/92/65/515/92/93/92 b

///////////////////////////////////////////////////////////////////////////////////////////////////////


//////DEVE HAREKET KONTROL POZİSYONLARI///////////////////////////////////////////////////////////////
92/9d2/9z2/5D5/92/65/515/92/93/92 w
92/9d2/8P12/5D5/4a6/416/515/92/93/92 w
92/9d2/9z2/5D5/4a6/416/515/92/93/92 w
2D8/912/317/614/515/515/92/92/93/8D2 w
2d8/912/317/614/515/515/92/92/93/8d2 b

///////////////////////////////////////////////////////////////////////////////////////////////////////


//////AT HAREKET KONTROL POZİSYONLARI///////////////////////////////////////////////////////////////
92/912/92/515/92/4A6/92/92/93/92 w
92/9D2/912/5A5/92/65/515/92/93/92 w
92/912/912/5A5/92/65/515/92/912/26D2 w

92/9d2/912/5a5/92/65/515/92/93/92 b
92/912/912/5a5/92/65/515/92/93/92 b
92/912/912/515/92/65/515/9a1/93/92 b
///////////////////////////////////////////////////////////////////////////////////////////////////////


//////MANCINIK HAREKET KONTROL POZİSYONLARI///////////////////////////////////////////////////////////////
92/912/317/515/5M5/416/92/92/93/92 w 4 YÖNE HAREKET
92/912/317/515/5m5/416/92/92/93/92 b 4 YÖNE HAREKET

92/912/317/6m4/5M5/416/92/92/93/92 w 3 YÖNE HAREKET
92/93/92/92/92/5M5/4h15/92/93/92 w 3 yöne hareket
92/93/92/3r3n3/41114/5M5/41114/92/2x9/92 w
92/93/92/92/4P1C4/5M5/4h1q4/92/93/92 w

///////////////////////////////////////////////////////////////////////////////////////////////////////

//////PİYONLAR HAREKET KONTROL POZİSYONLARI///////////////////////////////////////////////////////////////
218/912/rnxheqybctp/614/515/PTCBYQEHXNR/92/92/93/812 w
218/912/rnxheqybctp/614/515/5QEHXNR/92/92/93/812 w

218/912/rnxheqybctp/614/515/PTCBYQEHXNR/92/92/93/812 b
218/912/rnxheqybctp/614/515/5P5/92/92/93/812 w
218/912/rnxheqybctp/614/515/5P5/92/92/93/812 b
218/912/6y4/614/515/8X2/92/92/93/812 w
218/912/6y4/614/515/8X2/92/92/93/812 b
218/912/6y4/614/515/6B1C2/92/92/93/812 w

218/912/rnxheqybctp/614/515/P55/92/92/93/812 w
218/912/rnxheqybctp/614/515/P55/92/92/93/812 b
218/912/3heqybctp/614/515/P55/92/92/93/812 b

218/912/rnxheqybctp/614/515/PTCBYQEHXNR/92/92/93/812 w

218/9a1a/heqybctp3/614/515/55P/92/92/92A/812 b  FAZLA KARELERDEKİ TAŞI ALAMAMA KONTROLÜ

218/912/rnxheqybctp/PTCBYQEHXNR/515/92/92/92/93/812 w

///////////////////////////////////////////////////////////////////////////////////////////////////////

//////KALE HAREKET KONTROL POZİSYONLARI///////////////////////////////////////////////////////////////
92/911/5z5/92/92/5K3x1/515/92/93/92 w 4 YÖNE HAREKET
92/912/317/6m4/5K5/5k5/92/92/93/92 w
92/912/317/6M4/5K5/5k5/92/92/93/92 b
92/912/317/614/515/5k5/92/92/93/92 b
///////////////////////////////////////////////////////////////////////////////////////////////////////


//////DEBBABE HAREKET KONTROL POZİSYONLARI///////////////////////////////////////////////////////////////
218/912/6y4/614/5he4/6b1c2/92/6I4/93/812 w
218/912/614/614/524/632/92/6i4/93/812 b

///////////////////////////////////////////////////////////////////////////////////////////////////////

//////Ad king hatreketi kontrolu///////////////////////////////////////////////////////////////

218/912/6y4/614/5he4/6b1c2/92/6I4/93/8J2 w

///////////////////////////////////////////////////////////////////////////////////////////////////////




gui 278 //////////////////////////-----------------------////////////







     if(GameBoard.side == COLOURS.WHITE){

                    switch (PromPce) {


                        case PIECES.WkaleP:
                        case PIECES.WvezirP:
                        case PIECES.WgeneralP:
                        case PIECES.WatP:
                        case PIECES.WzurafaP:
                        case PIECES.WdebbabeP:
                        case PIECES.WdeveP:
                        case PIECES.WsahP:
                        case PIECES.WmancinikP:
                        case PIECES.WfilP:

                        case PIECES.WpiyonP:
                    }
                }else{

                    switch (PromPce) {

                        case PIECES.WpiyonP:
                        case PIECES.WkaleP:
                        case PIECES.WvezirP:
                        case PIECES.WgeneralP:
                        case PIECES.WatP:
                        case PIECES.WzurafaP:
                        case PIECES.WdebbabeP:
                        case PIECES.WdeveP:
                        case PIECES.WsahP:
                        case PIECES.WmancinikP:
                        case PIECES.WfilP:


                    }
                }
















//////ZURAFA HAREKET KONTROL POZİSYONLARI///////////////////////////////////////////////////////////////
92/93/92/92/92/5z5/5Z5/92/93/92 w        8 yönden açık
92/93/92/92/92/5z5/5Z5/92/93/92 b        8 yönden açık

92/93/92/92/92/515/5Z5/92/93/92 w        8 yönden açık
92/93/92/92/92/5Z5/515/92/93/92 w        8 yönden açık
92/93/92/92/92/515/5Zz4/92/93/92 w       8 yönden açık


713/615/31y1e4/92/2c131r2/5Z5/2h131q2/92/4x1p4/92 w  deve ile 8 yönden kapatma
713/615/31y1e4/92/2c131r2/5Z5/21131q2/92/4x1p4/92 w  deve ile 7 yönden kapatma
713/615/31y114/92/21131r2/5Z5/21131q2/92/4x114/92 w  deve ile 4 yönden kapatma
Z55/3i7/812/1e72/92/92/515/92/93/92 w                tam köşede deve ile 2 yönden kapatma
713/615/31y1e4/92/2c13112/5Z5/2h13112/92/411p4/92 w  deve ile 4 yönden kapatma

713/615/92/31y1e4/21c3r12/5Z5/3h3q3/4x1p4/92/92 w  at ile 8 yönden kapatma
713/615/92/31y1e4/21c3r12/5Z5/3h3q3/411p4/92/92 w at ile 7 yönden kapatma
713/615/92/92/21c3r12/5Z5/92/4x1p4/93/92 w at ile 4 yönden at ile kapatma
713/615/92/3111e4/21c3112/5Z5/313q3/4x114/92/92 w 4 yönden at ile kapatma
Z55/2i8/1e72/92/92/92/515/92/93/92 w                tam köşede at ile 2 yönden kapatma

713/615/92/31y1e4/21c2ir12/5Z5/3hi1bq3/4x1p4/4z1p5/92 w at, deve ve capraz kapatma

713/93/812/4p1e4/5Z5/4h1q4/515/92/93/92 w  capraz 4 yönden kapatma

713/93/812/4p1e4/5Z5/92/515/92/93/92 w  capraz 2 yönden kapatma
5Z5/4p1e41/812/92/92/92/515/92/93/92 w  alt CAPRAZ 2 YÖNDEN KAPATMA
5Z5/4p1e41/5i5/92/92/92/515/92/93/92 w   CAPRAZ 2 YÖNDEN KAPATMA
713/93/812/31p1e13/5Z5/92/515/92/93/92 w
92/9Z1/8z2/92/92/515/515/92/93/92 w
92/9Z1/92/92/92/515/515/92/93/92 w

713/93/812/4pre4/4pZi4/92/515/92/93/92 w capraz 2 yönden ve 2 yatay 1 dikey kapatma
713/93/812/4pre4/4pZ14/92/515/92/93/92 w capraz 2 yönden ve 1 yatay 1 dikey kapatma


Z55/218/1172/92/92/92/515/92/93/5z5 w fazla kareye hareket edememe kontrolü
///////////////////////////////////////////////////////////////////////////////////////////////////////


92/5s6/92/92/41A14/5M5/41114/92/5S6/92 w

///////////FAZLA KARELERE TAŞ EKLEME////////////////////////////////////////


218/92s/6y4/614/5he4/6b1c2/92/6I4/92S/812 w

///////////////////////////////////////////////////////////////////////////////////////////////////////



///////////////////////MAT OLMA DURUMULARI/////////////////////////////////////////////////////

92/9p2/92/8s2/92/5A5/5Z5/8A2/8S3/92 b

92/912/92/8s2/92/5A5/515/812/8S3/92 b

///////////////////////////////////////////////////////////////////////////////////////////////////////













    $(".Square").each(function () {

        var index,j,Cal_sq;

        for(index=0;index<WhitePawns.length;index++){

            if(clickedPiece==WhitePawns[index]){

                if (PawnAttackedSqStraightWhite(sq+PawnsFowards)==Bool.True ) {

                    if(ProtectedKing(sq,sq+PawnsFowards)==Bool.True && NotCapturedPawnOfPawn(clickedPiece,sq+PawnsFowards)==Bool.True){

                        if(PieceIsOnSq(sq+PawnsFowards,$(this).position().top,$(this).position().left)==Bool.True){

                            $(this).addClass("SqAttacked");
                        }
                    }
                }

                for(j=0;j<PawnDiagonal.length;j++){

                    if (PawnAttackedSqDiagonalWhite(sq+PawnDiagonal[j])==Bool.True ) {

                        if(ProtectedKing(sq,sq+PawnDiagonal[j])==Bool.True && NotCapturedPawnOfPawn(clickedPiece,sq+PawnDiagonal[j])==Bool.True){

                            if(PieceIsOnSq(sq+PawnDiagonal[j],$(this).position().top,$(this).position().left)==Bool.True){

                                $(this).addClass("SqAttacked");
                            }
                        }
                    }
                }
            }
        }

        for(index=0;index<BlackPawns.length;index++){

            if(clickedPiece==BlackPawns[index]){

                if (PawnAttackedSqStraightBlack(sq-PawnsFowards)==Bool.True ) {

                    if(ProtectedKing(sq,sq-PawnsFowards)==Bool.True && NotCapturedPawnOfPawn(clickedPiece,sq-PawnsFowards)==Bool.True){

                        if(PieceIsOnSq(sq-PawnsFowards,$(this).position().top,$(this).position().left)==Bool.True){

                            $(this).addClass("SqAttacked");
                        }
                    }
                }

                for(j=0;j<PawnDiagonal.length;j++){

                    if (PawnAttackedSqDiagonalBlack(sq-PawnDiagonal[j])==Bool.True ) {

                        if(ProtectedKing(sq,sq-PawnDiagonal[j])==Bool.True && NotCapturedPawnOfPawn(clickedPiece,sq-PawnDiagonal[j])==Bool.True){

                            if(PieceIsOnSq(sq-PawnDiagonal[j],$(this).position().top,$(this).position().left)==Bool.True){

                                $(this).addClass("SqAttacked");
                            }
                        }
                    }
                }
            }
        }

        var PieceNumber,Direction,new_sq;

        for(index=0;index<LoopNonSlidePieces.length;index++){

            for (PieceNumber = 0; PieceNumber < GameBoard.piecesNUMBER[clickedPiece]; ++PieceNumber) {
                Cal_sq = GameBoard.pList[PCEINDEX(clickedPiece, PieceNumber)];

                if( LoopNonSlidePieces[index] == clickedPiece && sq==Cal_sq) {

                    for (j = 0; j < DirectionNumber[clickedPiece]; j++) {
                        Direction = PieceDirection[clickedPiece][j];

                        new_sq = sq + Direction;

                        if (SQOFFBOARD(new_sq) == Bool.True) {

                            continue;
                        }

                        if (GameBoard.pieces[new_sq] != PIECES.EMPTY) {
                            if (PieceColor[GameBoard.pieces[new_sq]] != GameBoard.side ) {

                                if(new_sq==88 || new_sq==181){
                                    continue;
                                }

                                if(ProtectedKing(sq,new_sq)==Bool.True && NotCapturedPawnOfPawn(clickedPiece,new_sq)==Bool.True){

                                    if(PieceIsOnSq(new_sq,$(this).position().top,$(this).position().left)==Bool.True &&
                                        PieceColor[GameBoard.pieces[sq]] == GameBoard.side){
                                        $(this).addClass("SqAttacked");
                                    }

                                }
                            }
                        } else {

                            if(new_sq==88 || new_sq==181){
                                continue;
                            }

                            if(ProtectedKing(sq,new_sq)==Bool.True && NotCapturedPawnOfPawn(clickedPiece,new_sq)==Bool.True){

                                if(PieceIsOnSq(new_sq,$(this).position().top,$(this).position().left)==Bool.True &&
                                    PieceColor[GameBoard.pieces[sq]] == GameBoard.side){
                                    $(this).addClass("SqAttacked");
                                }
                            }
                        }
                    }
                }
            }
        }

        for(index=0;index < LoopSlideKale.length;index++){

            for (PieceNumber = 0; PieceNumber < GameBoard.piecesNUMBER[clickedPiece]; ++PieceNumber) {
                Cal_sq = GameBoard.pList[PCEINDEX(clickedPiece, PieceNumber)];

                if( LoopSlideKale[index] == clickedPiece && sq==Cal_sq) {

                    for (index = 0; index < DirectionNumber[clickedPiece]; index++) {
                        Direction = PieceDirection[clickedPiece][index];
                        new_sq = sq + Direction;

                        while (SQOFFBOARD(new_sq) == Bool.False) {

                            if (GameBoard.pieces[new_sq] != PIECES.EMPTY) {
                                if (PieceColor[GameBoard.pieces[new_sq]] != GameBoard.side) {

                                    if(new_sq==88 || new_sq==181){
                                        new_sq += Direction;
                                        continue;
                                    }

                                    if(ProtectedKing(sq,new_sq)==Bool.True && NotCapturedPawnOfPawn(clickedPiece,new_sq)==Bool.True){

                                        if(PieceIsOnSq(new_sq,$(this).position().top,$(this).position().left)==Bool.True &&
                                            PieceColor[GameBoard.pieces[sq]] == GameBoard.side){
                                            $(this).addClass("SqAttacked");
                                        }
                                    }

                                }
                                break;
                            }
                            if(new_sq==88 || new_sq==181){
                                new_sq += Direction;
                                continue;
                            }

                            if(ProtectedKing(sq,new_sq)==Bool.True && NotCapturedPawnOfPawn(clickedPiece,new_sq)==Bool.True){

                                if(PieceIsOnSq(new_sq,$(this).position().top,$(this).position().left)==Bool.True &&
                                    PieceColor[GameBoard.pieces[sq]] == GameBoard.side){
                                    $(this).addClass("SqAttacked");
                                }
                            }

                            new_sq += Direction;
                        }
                    }
                }
            }
        }

        for(index=0;index < LoopSlideMancinik.length;index++){

            for (PieceNumber = 0; PieceNumber < GameBoard.piecesNUMBER[clickedPiece]; ++PieceNumber) {
                Cal_sq = GameBoard.pList[PCEINDEX(clickedPiece, PieceNumber)];

                if( LoopSlideMancinik[index] == clickedPiece && sq==Cal_sq) {

                    for (j = 0; j < DirectionNumber[clickedPiece]; j++) {
                        Direction = PieceDirection[clickedPiece][j];
                        new_sq = sq + Direction;

                        if(GameBoard.pieces[sq+GENERAL_direction[j]]==PIECES.EMPTY){

                            while (SQOFFBOARD(new_sq) == Bool.False) {

                                if (GameBoard.pieces[new_sq] != PIECES.EMPTY  ) {

                                    if (PieceColor[GameBoard.pieces[new_sq]] != GameBoard.side) {

                                        if(new_sq==88 || new_sq==181){
                                            new_sq += GENERAL_direction[j];
                                            continue;
                                        }

                                        if(ProtectedKing(sq,new_sq)==Bool.True && NotCapturedPawnOfPawn(clickedPiece,new_sq)==Bool.True){

                                            if(PieceIsOnSq(new_sq,$(this).position().top,$(this).position().left)==Bool.True &&
                                                PieceColor[GameBoard.pieces[sq]] == GameBoard.side){
                                                $(this).addClass("SqAttacked");
                                            }
                                        }

                                    }
                                    break;
                                }

                                if(new_sq==88 || new_sq==181){
                                    new_sq += GENERAL_direction[j];
                                    continue;
                                }

                                if(ProtectedKing(sq,new_sq)==Bool.True && NotCapturedPawnOfPawn(clickedPiece,new_sq)==Bool.True){

                                    if(PieceIsOnSq(new_sq,$(this).position().top,$(this).position().left)==Bool.True &&
                                        PieceColor[GameBoard.pieces[sq]] == GameBoard.side){
                                        $(this).addClass("SqAttacked");
                                    }
                                }

                                new_sq += GENERAL_direction[j];
                            }
                        }
                    }
                }
            }
        }

        for(index=0;index < LoopSlideZurafa.length;index++){

            for (PieceNumber = 0; PieceNumber < GameBoard.piecesNUMBER[clickedPiece]; ++PieceNumber) {
                Cal_sq = GameBoard.pList[PCEINDEX(clickedPiece, PieceNumber)];

                if(LoopSlideZurafa[index]==clickedPiece && sq==Cal_sq){

                    for(j=0;j<DirectionNumber[clickedPiece];j++){

                        Direction = PieceDirection[clickedPiece][j];
                        new_sq = sq + Direction;

                        if(GameBoard.pieces[sq+ZURAFA3_direction[j]]==PIECES.EMPTY && GameBoard.pieces[sq+AT_direction[j]]==PIECES.EMPTY &&
                            GameBoard.pieces[sq+DEVE_direction[j]]==PIECES.EMPTY ){

                            while (SQOFFBOARD(new_sq) == Bool.False) {

                                if (GameBoard.pieces[new_sq] != PIECES.EMPTY) {
                                    if (PieceColor[GameBoard.pieces[new_sq]] != GameBoard.side) {

                                        if(new_sq==88 || new_sq==181){
                                            new_sq += ZURAFA2_direction[j];
                                            continue;
                                        }


                                        if(ProtectedKing(sq,new_sq)==Bool.True && NotCapturedPawnOfPawn(clickedPiece,new_sq)==Bool.True){

                                            if(PieceIsOnSq(new_sq,$(this).position().top,$(this).position().left)==Bool.True &&
                                                PieceColor[GameBoard.pieces[sq]] == GameBoard.side){
                                                $(this).addClass("SqAttacked");
                                            }
                                        }

                                    }
                                    break;
                                }
                                if(new_sq==88 || new_sq==181){
                                    new_sq += ZURAFA2_direction[j];
                                    continue;
                                }

                                if(ProtectedKing(sq,new_sq)==Bool.True && NotCapturedPawnOfPawn(clickedPiece,new_sq)==Bool.True){

                                    if(PieceIsOnSq(new_sq,$(this).position().top,$(this).position().left)==Bool.True &&
                                        PieceColor[GameBoard.pieces[sq]] == GameBoard.side){
                                        $(this).addClass("SqAttacked");
                                    }
                                }

                                new_sq += ZURAFA2_direction[j];
                            }
                        }
                    }
                }
            }
        }

        for(index=0;index < LoopKings.length;index++){

            for (PieceNumber = 0; PieceNumber < GameBoard.piecesNUMBER[clickedPiece]; ++PieceNumber) {
                Cal_sq = GameBoard.pList[PCEINDEX(clickedPiece, PieceNumber)];

                if (LoopKings[index] == clickedPiece && sq == Cal_sq) {

                    for (j = 0; j < DirectionNumber[clickedPiece]; j++) {
                        Direction = PieceDirection[clickedPiece][j];

                        new_sq = sq + Direction;

                        if (SQOFFBOARD(new_sq) == Bool.True) {

                            continue;
                        }

                        if (GameBoard.pieces[new_sq] != PIECES.EMPTY) {

                            if(new_sq==WsideCitadel || new_sq==BsideCitadel) continue;

                            if ( PieceColor[GameBoard.pieces[new_sq]] != GameBoard.side) {

                                if(GameBoard.side==COLOURS.WHITE){

                                    if( ( (GameBoard.WhiteKingsInGame.length==1 && SqAttacked(new_sq,GameBoard.side^1)==Bool.False) ||
                                         (GameBoard.WhiteKingsInGame.length>1) )  && NotCapturedPawnOfPawn(clickedPiece,new_sq)==Bool.True){

                                        if(PieceIsOnSq(new_sq,$(this).position().top,$(this).position().left)==Bool.True &&
                                            PieceColor[GameBoard.pieces[sq]] == GameBoard.side){
                                            $(this).addClass("SqAttacked");
                                        }
                                    }
                                }

                                if(GameBoard.side==COLOURS.BLACK){

                                    if( ( (GameBoard.BlackKingsInGame.length==1 && SqAttacked(new_sq,GameBoard.side^1)==Bool.False) ||
                                        (GameBoard.BlackKingsInGame.length>1)) && NotCapturedPawnOfPawn(clickedPiece,new_sq)==Bool.True) {

                                        if(PieceIsOnSq(new_sq,$(this).position().top,$(this).position().left)==Bool.True &&
                                            PieceColor[GameBoard.pieces[sq]] == GameBoard.side){
                                            $(this).addClass("SqAttacked");
                                        }
                                    }
                                }
                            }
                        }

                        else {

                            if (PieceColor[GameBoard.pieces[sq]] == COLOURS.WHITE) {

                                if( (new_sq==WsideCitadel  && GameBoard.pieces[sq]!=PIECES.WmaceraciSah) ||
                                    (new_sq==BsideCitadel && GameBoard.pieces[sq]!=GameBoard.WhiteHighestRanKING)){

                                    continue;
                                }

                                if(GameBoard.side==COLOURS.WHITE){

                                    if( ((GameBoard.WhiteKingsInGame.length==1 && SqAttacked(new_sq,GameBoard.side^1)==Bool.False) ||
                                        (GameBoard.WhiteKingsInGame.length>1) ) && NotCapturedPawnOfPawn(clickedPiece,new_sq)==Bool.True ) {

                                        if(PieceIsOnSq(new_sq,$(this).position().top,$(this).position().left)==Bool.True &&
                                            PieceColor[GameBoard.pieces[sq]] == GameBoard.side){
                                            $(this).addClass("SqAttacked");
                                        }
                                    }
                                }

                            } else if (PieceColor[GameBoard.pieces[sq]] == COLOURS.BLACK) {


                                if( (new_sq==BsideCitadel && GameBoard.pieces[sq]!=PIECES.BmaceraciSah) ||
                                    (new_sq==WsideCitadel && GameBoard.pieces[sq]!=GameBoard.BlackHighestRanKING) ){

                                    continue;
                                }

                                if(GameBoard.side==COLOURS.BLACK){

                                    if( ( (GameBoard.BlackKingsInGame.length==1 && SqAttacked(new_sq,GameBoard.side^1)==Bool.False) ||
                                        (GameBoard.BlackKingsInGame.length>1) ) && NotCapturedPawnOfPawn(clickedPiece,new_sq)==Bool.True ) {

                                        if(PieceIsOnSq(new_sq,$(this).position().top,$(this).position().left)==Bool.True &&
                                            PieceColor[GameBoard.pieces[sq]] == GameBoard.side){
                                            $(this).addClass("SqAttacked");
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }


        if (GameBoard.side==COLOURS.WHITE && clickedPiece==GameBoard.WhiteOnlyKingInGame &&
            SqAttacked(sq,GameBoard.side^1)==Bool.True && WsoleKingSwitchPlacePiece==0){

            for(index=0;index<WhitePceList.length;index++){

                new_sq=WhitePceList[index];

                if(PieceIsOnSq(new_sq,$(this).position().top,$(this).position().left)==Bool.True ){
                    $(this).addClass("SqAttacked");
                }
            }
        }

        if (GameBoard.side==COLOURS.BLACK && clickedPiece==GameBoard.BlackOnlyKingInGame &&
            SqAttacked(sq,GameBoard.side^1)==Bool.True && BsoleKingSwitchPlacePiece==0){

            for(index=0;index<BlackPceList.length;index++){

                new_sq=BlackPceList[index];

                if(PieceIsOnSq(new_sq,$(this).position().top,$(this).position().left)==Bool.True ){
                    $(this).addClass("SqAttacked");
                }
            }
        }

    });

 */